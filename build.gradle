buildscript {
    repositories {
        mavenCentral()
    }
    dependencies {
        classpath "org.flywaydb:flyway-gradle-plugin:3.0"
    }
}
apply plugin: 'java'
apply plugin: 'war'
apply plugin: 'idea'
apply plugin: 'flyway'

version = "1.0-SNAPSHOT"

sourceCompatibility = 1.8

ext {
  libraryVersions = [
        junit: '4.11', arquillian: '1.1.5.Final',
        javaeeApi: '7.0',  slf4j: '1.7.5', log4j: '1.7.5',
        keycloak: '1.0-rc-1', deltaSpike: '1.0.1'

  ] 
}
// If profile is set try to apply the profile file, if not, use the wildfly profile
if(!hasProperty('profile')){
    apply from: 'wildfly-managed-profile.gradle'
}else{
    apply from: profile +'-profile.gradle'
}



configurations {
   provided
}


repositories {
    mavenCentral()
    maven { 
      url "http://repository.jboss.org/nexus/content/groups/public" 
    }
}


dependencies {
    provided 'javax:javaee-api:7.0'
    testCompile group: 'junit', name: 'junit', version: libraryVersions.junit
    testCompile group: 'org.jboss.arquillian.junit', name: 'arquillian-junit-container', version: libraryVersions.arquillian
    testCompile 'com.icegreen:greenmail:1.3.1b'
    provided 'org.hibernate:hibernate-entitymanager:4.3.5.Final'
    provided 'org.hibernate:hibernate-validator:5.1.1.Final'
    provided "org.keycloak:keycloak-core:$libraryVersions.keycloak"
    provided "org.keycloak:keycloak-adapter-core:$libraryVersions.keycloak"
    compile 'commons-beanutils:commons-beanutils:1.9.2'
    compile "org.apache.deltaspike.core:deltaspike-core-api:$libraryVersions.deltaSpike"
    runtime "org.apache.deltaspike.core:deltaspike-core-impl:$libraryVersions.deltaSpike"
    compile "org.flywaydb:flyway-core:3.0"


}

// Configure source class path
sourceSets {
  main {
         compileClasspath += [configurations.provided]
  }
  test {
       compileClasspath += [configurations.provided]
  }
}

// optional: if using 'idea' plugin
// Configure intellij IDEA classpath for provided scope
idea {
    module{
        downloadJavadoc = true
        scopes.PROVIDED.plus += [configurations.provided]
    }
}

task wrapper(type: Wrapper) {
    gradleVersion = '1.12'
}
